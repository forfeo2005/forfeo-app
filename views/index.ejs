<script>
/**
 * GÃ¨re l'ouverture et la fermeture de la fenÃªtre de chat Forfy
 */
function toggleForfy() {
    const chat = document.getElementById('forfyChat');
    if (chat) {
        // Alterne entre l'affichage flex et aucun pour ouvrir/fermer
        chat.style.display = (chat.style.display === 'none' || chat.style.display === '') ? 'flex' : 'none';
    }
}

/**
 * GÃ¨re les rÃ©ponses interactives et les redirections
 * @param {string} action - Le type de bouton cliquÃ©
 */
function handleForfy(action) {
    const content = document.getElementById('chatContent');
    const options = document.getElementById('chatOptions');
    
    // Si l'un des Ã©lÃ©ments est manquant, on arrÃªte
    if (!content || !options) return;

    switch(action) {
        case 'ambassadeur':
            content.innerHTML = "Excellent choix ! Le recrutement est ouvert. PrÃªt Ã  rejoindre l'Ã©lite et passer le scanner de validation ? âœ¨";
            options.innerHTML = `
                <button onclick="window.location.href='/ambassadeur/inscription'">Lancer le scanner ğŸš€</button>
                <button onclick="handleForfy('start')">â¬… Retour</button>
            `;
            break;

        case 'tarifs':
            content.innerHTML = "Nos forfaits Entreprise au Canada commencent Ã  49$ CAD. Quel niveau d'audit visez-vous pour votre Ã©tablissement ?";
            options.innerHTML = `
                <button onclick="window.location.href='#forfaits'">Voir les forfaits ğŸ’°</button>
                <button onclick="handleForfy('start')">â¬… Retour</button>
            `;
            break;

        case 'audit':
            content.innerHTML = "Besoin de soumettre un rapport ? Connectez-vous Ã  votre tableau de bord sÃ©curisÃ© pour remplir vos Ã©valuations.";
            options.innerHTML = `
                <button onclick="window.location.href='/entreprise/dashboard'">AccÃ©der au Portail ğŸ–¥ï¸</button>
                <button onclick="handleForfy('start')">â¬… Retour</button>
            `;
            break;

        case 'start':
        default:
            content.innerHTML = "Besoin d'autre chose ? Je suis lÃ  pour vous aider Ã  naviguer dans l'univers Forfeo ! ğŸ¾";
            options.innerHTML = `
                <button onclick="handleForfy('ambassadeur')">Devenir Ambassadeur ğŸ¤</button>
                <button onclick="handleForfy('tarifs')">Voir les Tarifs CAD ğŸ’°</button>
                <button onclick="handleForfy('audit')">Ma mission d'audit ğŸ“‹</button>
            `;
            break;
    }
}

// Initialise Forfy pour qu'il soit fermÃ© au chargement de la page
document.addEventListener('DOMContentLoaded', () => {
    const chat = document.getElementById('forfyChat');
    if (chat) chat.style.display = 'none';
});
</script>
