<!DOCTYPE html>
<html lang="fr-CA">
<head>
    <meta charset="UTF-8">
    <title>Administration - FORFEO</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
</head>
<body class="bg-dark text-white">

    <div class="container py-5">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1 class="fw-bold"><i class="bi bi-shield-lock-fill me-2"></i>Espace Administration</h1>
            <a href="/login" class="btn btn-outline-light btn-sm">Déconnexion</a>
        </div>

        <div class="card border-0 shadow-lg">
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="table-light">
                            <tr>
                                <th scope="col">Date</th>
                                <th scope="col">Client</th>
                                <th scope="col">Mission</th>
                                <th scope="col">Détails</th>
                                <th scope="col">Statut Actuel</th>
                                <th scope="col">Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% if (missions.length === 0) { %>
                                <tr>
                                    <td colspan="6" class="text-center p-5 text-muted">Aucune mission trouvée.</td>
                                </tr>
                            <% } else { %>
                                <% missions.forEach(function(m) { %>
                                    <tr>
                                        <td><%= m.date_souhaitee %></td>
                                        <td class="fw-bold text-primary"><%= m.client_nom %></td>
                                        <td><%= m.type_mission %></td>
                                        <td><small class="text-muted"><%= m.details %></small></td>
                                        <td>
                                            <% if(m.statut === 'En attente') { %>
                                                <span class="badge bg-warning text-dark">En attente</span>
                                            <% } else if (m.statut === 'Terminée') { %>
                                                <span class="badge bg-success">Terminée</span>
                                            <% } else { %>
                                                <span class="badge bg-secondary"><%= m.statut %></span>
                                            <% } %>
                                        </td>
                                        <td>
                                            <form action="/admin/update" method="POST" class="d-flex gap-2">
                                                <input type="hidden" name="missionId" value="<%= m.id %>">
                                                <select name="newStatus" class="form-select form-select-sm" style="width: 130px;">
                                                    <option value="En cours">En cours</option>
                                                    <option value="Terminée">Terminée</option>
                                                    <option value="Annulée">Annulée</option>
                                                </select>
                                                <button type="submit" class="btn btn-sm btn-dark"><i class="bi bi-check-lg"></i></button>
                                            </form>
                                        </td>
                                    </tr>
                                <% }); %>
                            <% } %>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

</body>
</html>
